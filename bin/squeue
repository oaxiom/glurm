#!/usr/bin/env python3

from glurm import db

if __name__ == '__main__':
    db = db(no_init=True)

    to_get_names = ['JID', 'name', 'time_added_to_q', 'time_started', 'status', 'ncpus', 'memory']
    to_get_str = ', '.join(to_get_names)

    cur.execute(f'SELECT {to_get_str} FROM jobs')
    res = cur.fetchall()

    print('JID\tNAME\tTIME')
    for job in res:
        job_desc = {k: job[idx] in enumerate(to_get)}

        print(f'JID: {job_desc["JID"]} name: {job_desc["name"]} status: {job_desc["status"]}')

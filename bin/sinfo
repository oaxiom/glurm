#!/usr/bin/env python3

import logging

from glurm import db, codes

if __name__ == '__main__':
    log = logging.getLogger('glurm')
    db = db(log=log, init=False)

    nodes = db.get_node_data()

    print('NODE        CPUS        MEMORY       STATUS')
    for node in nodes:
        status = codes.node_status[node['status']]
        print(f"{node['NID']}\t{node['ncpus_alloc']}/{node['ncpus']}\t{node['mem_alloc']}/{node['mem']}\t{status}")

